---
title: "Regularization Selection for Optimal Weighting"
format: html
---

# Overview

This vignette demonstrates how to use the `select_optimal_regularization()` function to choose the best regularization parameter for weighting matrices in moment-based tests. This is essential for robust hypothesis testing.

# Setup

```r
library(purrr)
library(tibble)
library(MASS)
source("../R/moments_and_statistics.R")
source("../R/regularization_selection.R")
```

# Example: Selecting Regularization

Suppose you have a sample from the null distribution and want to select the optimal regularization parameter.

```r
set.seed(42)
x <- rnorm(100)
c_grid <- c(50, 20, 10, 0.1, 0.001, 0.000001, 0.000000001, 0)
beta <- select_optimal_regularization(
  n = 100,
  c_grid = c_grid,
  moment_order = 3,
  n_sim = 8,
  n_boot = 100,
  x = x
)
beta
```

# Interpretation

The returned value is the optimal regularization parameter (beta) to use in the weighting matrix for subsequent hypothesis tests.

# Summary

This function is typically used inside simulation or testing workflows to ensure the weighting matrix is well-conditioned and the test is robust.
